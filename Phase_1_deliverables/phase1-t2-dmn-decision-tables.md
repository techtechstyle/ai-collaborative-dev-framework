# T2: L0-L4 判断条件の DMN決定表

> **タスク**: T1の抽出結果をDMN決定表形式のMarkdown表に変換する
> **検証方法**: 各レベルの入力・条件・出力が明示されていること
> **自信度**: 確実（T1の抽出データからの構造的変換）
> **入力**: `phase1-t1-decision-conditions.md`

---

## DMN決定表の読み方

本ドキュメントで使用するDMN決定表の構成要素：

| 要素 | 説明 |
|------|------|
| **ヒットポリシー** | 複数ルールが合致した場合の処理方法 |
| **入力列(I)** | 判断に使用する条件（状況・観測値） |
| **出力列(O)** | 条件合致時に取るべきアクション |
| **ルール行** | 入力条件の組み合わせと対応する出力 |

**ヒットポリシーの種類（本ドキュメントで使用するもの）:**

| 記号 | ポリシー | 説明 |
|------|---------|------|
| **P** | Priority（優先度） | 複数合致時、優先度が最も高いルールを適用 |
| **F** | First（最初一致） | 上から順に評価し、最初に合致したルールを適用 |
| **U** | Unique（一意） | 常に1つのルールのみが合致（排他的条件） |
| **C** | Collect（収集） | 合致するすべてのルールの出力を収集 |

---

## DT-0: Bright Lines 事前チェック（全フローに先行）

> **すべての判断フローに先行して適用される。**
> L0-L4の判断に入る前に、Bright Lines違反がないか確認する。

**ヒットポリシー: F（最初一致）** — 1つでも該当すれば即停止

| # | I: 現在の状況 | O: 判定 | O: アクション |
|---|--------------|---------|--------------|
| BL1 | 人間の最終判断権を放棄しようとしている | **違反** | 即座に停止。判断権を人間に戻す |
| BL2 | 検証なしで本番環境に適用しようとしている | **違反** | 即座に停止。検証ステップを挿入する |
| BL3 | 理解せずにコードを採用しようとしている | **違反** | 即座に停止。コードの理解を先行させる |
| BL4 | AIの出力を盲目的に信頼している | **違反** | 即座に停止。独立した検証を実施する |
| - | 上記いずれにも該当しない | **通過** | L0-L4階層判断フローへ進む |

---

## DT-1: L0-L4 階層判断フロー（メインフロー）

> **判断が必要な状況が発生したときに、L0から順にチェックする。**
> 各レベルを通過して初めて次のレベルへ進める。

**ヒットポリシー: F（最初一致）** — 上位レベルから順に評価、最初のNoで分岐

| # | I: 評価レベル | I: 判断の問い | I: 評価結果 | O: アクション | O: 次ステップ |
|---|-------------|-------------|-----------|--------------|-------------|
| 1 | L0 持続可能性 | 1年後のチームにプラスか？ | No | その選択肢を却下する | 別の選択肢で再度L0から |
| 2 | L0 持続可能性 | 1年後のチームにプラスか？ | Yes | L0通過 | → L1へ |
| 3 | L1 心理的安全性 | 誰かが萎縮しないか？ | No | 萎縮しない方法を検討する | 方法変更後L1を再評価 |
| 4 | L1 心理的安全性 | 誰かが萎縮しないか？ | Yes | L1通過 | → L2へ |
| 5 | L2 急がば回れ | 丁寧さを保てるか？ | No | 丁寧にできる範囲に縮小する | 縮小後L2を再評価 |
| 6 | L2 急がば回れ | 丁寧さを保てるか？ | Yes | L2通過 | → L3へ |
| 7 | L3 シンプルさ | 1文1検証を満たせるか？ | No | よりシンプルな方法を選択する | 選択後L3を再評価 |
| 8 | L3 シンプルさ | 1文1検証を満たせるか？ | Yes | L3通過 | → L4へ |
| 9 | L4 AIファースト | AIの強みを活用できるか？ | No | 人間が直接実行する | 実行へ |
| 10 | L4 AIファースト | AIの強みを活用できるか？ | Yes | AIに委譲して実行する | 実行へ |

---

## DT-2: L0 持続可能性 — 詳細判断表

> **L0通過の詳細判断。**
> 関連する6原則（G1-G3, R1-R3）それぞれの観点でチェックする。

**ヒットポリシー: C（収集）** — 全ルールを評価し、Noが1つでもあれば要対応

| # | I: 原則 | I: 自問 | I: 回答 | O: 判定 | O: 対応策 |
|---|--------|--------|---------|---------|----------|
| 1 | G1 任せるだけでなく学ぶ | このコードを自分で説明できるか？ | No | **要対応** | AIに説明を求める／ティーチングモードを使用 |
| 2 | G1 任せるだけでなく学ぶ | このコードを自分で説明できるか？ | Yes | 通過 | — |
| 3 | G2 個人→チームへ展開 | 学びを記録しているか？ | No | **要対応** | CLAUDE.mdまたは知見ドキュメントに記録 |
| 4 | G2 個人→チームへ展開 | 学びを記録しているか？ | Yes | 通過 | — |
| 5 | G3 CLAUDE.mdは監視の憲法 | 1年後も価値があるか？ | No | **要対応** | CLAUDE.mdの関連ルールを見直す |
| 6 | G3 CLAUDE.mdは監視の憲法 | 1年後も価値があるか？ | Yes | 通過 | — |
| 7 | R1 スキルの可逆性 | このコード、自分で書けるか？ | No | **要対応** | 月1回の手動実装で能力を維持 |
| 8 | R1 スキルの可逆性 | このコード、自分で書けるか？ | Yes | 通過 | — |
| 9 | R2 プロセスの可逆性 | AIなしでも手順は成立するか？ | No | **要対応** | AIなしの手順を並行して文書化 |
| 10 | R2 プロセスの可逆性 | AIなしでも手順は成立するか？ | Yes | 通過 | — |
| 11 | R3 判断の可逆性 | この判断を覆す根拠を説明できるか？ | No | **要対応** | AIの提案を批判的に評価し直す |
| 12 | R3 判断の可逆性 | この判断を覆す根拠を説明できるか？ | Yes | 通過 | — |

**集約ルール:** 「要対応」が1つ以上 → 対応策を実施してからL0通過判断を再評価

---

## DT-3: L1 心理的安全性 — 詳細判断表

> **L1通過の詳細判断。**
> 関連する3原則（P1-P3）の観点でチェックする。

**ヒットポリシー: C（収集）** — 全ルールを評価し、Noが1つでもあれば要対応

| # | I: 原則 | I: 自問 | I: 回答 | O: 判定 | O: 対応策 |
|---|--------|--------|---------|---------|----------|
| 1 | P1 責めない・記録する | 失敗を隠していないか？ | Yes（隠している） | **要対応** | 失敗をCLAUDE.mdに記録。責めずに学ぶ |
| 2 | P1 責めない・記録する | 失敗を隠していないか？ | No（隠していない） | 通過 | — |
| 3 | P2 損切りは判断 | 撤退を躊躇していないか？ | Yes（躊躇している） | **要対応** | 「撤退＝敗北ではなく判断」と再認識 |
| 4 | P2 損切りは判断 | 撤退を躊躇していないか？ | No（躊躇していない） | 通過 | — |
| 5 | P3 完璧より改善 | 完璧主義に陥っていないか？ | Yes（陥っている） | **要対応** | 完璧を目指すのではなくサイクルで改善 |
| 6 | P3 完璧より改善 | 完璧主義に陥っていないか？ | No（陥っていない） | 通過 | — |

**集約ルール:** 「要対応」が1つ以上 → 対応策を実施してからL1通過判断を再評価

---

## DT-4: L2 急がば回れ — 詳細判断表

> **L2通過の詳細判断。**
> 関連する3原則（H1-H3）の観点でチェックする。

**ヒットポリシー: C（収集）** — 全ルールを評価し、Noが1つでもあれば要対応

| # | I: 原則 | I: 自問 | I: 回答 | O: 判定 | O: 対応策 |
|---|--------|--------|---------|---------|----------|
| 1 | H1 設計→実装→検証 | 検証を挟んでいるか？ | No | **要対応** | 設計→実装→検証の順序を確保する |
| 2 | H1 設計→実装→検証 | 検証を挟んでいるか？ | Yes | 通過 | — |
| 3 | H2 早期発見・早期対処 | 問題を先送りしていないか？ | Yes（先送りしている） | **要対応** | 問題を今のステップで解決する |
| 4 | H2 早期発見・早期対処 | 問題を先送りしていないか？ | No（先送りしていない） | 通過 | — |
| 5 | H3 準備と振り返りに投資 | 振り返りを省略していないか？ | Yes（省略している） | **要対応** | 振り返りの時間を確保する |
| 6 | H3 準備と振り返りに投資 | 振り返りを省略していないか？ | No（省略していない） | 通過 | — |

**集約ルール:** 「要対応」が1つ以上 → 対応策を実施してからL2通過判断を再評価

---

## DT-5: L3 シンプルさ — 詳細判断表

> **L3通過の詳細判断。**
> 関連する3原則（S1-S3）の観点でチェックする。

**ヒットポリシー: C（収集）** — 全ルールを評価し、Noが1つでもあれば要対応

| # | I: 原則 | I: 自問 | I: 回答 | O: 判定 | O: 対応策 |
|---|--------|--------|---------|---------|----------|
| 1 | S1 1文1検証 | 1文で説明できるか？ | No | **要対応** | タスクをさらに分解する |
| 2 | S1 1文1検証 | 1文で説明できるか？ | Yes | 通過 | — |
| 3 | S1 YAGNI | 今必要なものだけか？ | No | **要対応** | 「将来のため」のスコープを除去 |
| 4 | S1 YAGNI | 今必要なものだけか？ | Yes | 通過 | — |
| 5 | S2 1ファイル=1責務 | 責務が複数になっていないか？ | Yes（複数ある） | **要対応** | ファイルを分割し単一責務にする |
| 6 | S2 1ファイル=1責務 | 責務が複数になっていないか？ | No（単一責務） | 通過 | — |
| 7 | S3 最小入力→検証可能出力 | 入力が複雑になっていないか？ | Yes（複雑） | **要対応** | 入力を簡潔に再構成する |
| 8 | S3 最小入力→検証可能出力 | 入力が複雑になっていないか？ | No（簡潔） | 通過 | — |

**集約ルール:** 「要対応」が1つ以上 → 対応策を実施してからL3通過判断を再評価

---

## DT-6: L4 AIファースト — 分業判断表

> **L0-L3をすべて通過した後のみ適用。**
> タスクの特性に応じて人間/AIの分業を判断する。

**ヒットポリシー: U（一意）** — 各ルールは排他的条件

| # | I: タスク特性 | I: F1判断: AIが得意な作業か？ | I: F2判断: 一貫性 vs 創造性 | O: 担当 | O: 適用原則 |
|---|-------------|---------------------------|-------------------------|---------|-----------|
| 1 | 初期案・たたき台の作成 | はい | 一貫性重視 | **AI主導** | F1: 初期案生成はAIから |
| 2 | スタイル統一・規約遵守 | はい | 一貫性重視 | **AI主導** | F2: 一貫性確保はAIに委譲 |
| 3 | 漏れ・抜けの検出 | はい | — | **AI主導** | F3: 網羅性チェックはAIに依頼 |
| 4 | 設計判断・アーキテクチャ | いいえ | 創造性重視 | **人間主導** | 人間が判断、AIは壁打ち相手 |
| 5 | ドメイン固有の判断 | いいえ | — | **人間主導** | 人間が判断、AIは情報提供 |
| 6 | 上記以外 | 不明 | — | **要判断** | F4でプロンプト設計を最適化して試行 |

---

## DT-7: L4 プロンプト技法選択表

> **F4（プロンプト設計の最適化）の詳細判断。**
> タスクの複雑さ・重要度に応じて適切な技法を選択する。

**ヒットポリシー: U（一意）** — タスク特性で一意に決定

| # | I: タスクの複雑さ | I: タスクの特性 | O: 推奨技法 | O: 説明 |
|---|-----------------|---------------|-----------|---------|
| 1 | シンプル | 明確な指示で十分 | Zero-shot | そのまま指示する |
| 2 | 中程度 | 推論・段階的思考が必要 | Chain of Thought | 段階的に考えさせる |
| 3 | 高い | 複数の選択肢を比較検討 | Tree of Thoughts | 分岐を探索させる |
| 4 | 高い | 外部情報の参照が必要 | ReAct | 推論と行動を交互に実行 |
| 5 | 最高 | 確実性が極めて重要 | Self-consistency | 複数回実行して多数決 |

---

## DT-8: 協働原則チェック表（プロセス中に適用）

> **タスク実行中に人間・AI双方が守るべきプロセスルール。**
> 実行フローの各ステップで並行してチェックする。

**ヒットポリシー: C（収集）** — 全ルールを常に評価

| # | I: 原則 | I: チェック対象 | I: 遵守されているか？ | O: 判定 | O: 是正アクション |
|---|--------|---------------|---------------------|---------|-----------------|
| 1 | C1 認識の確認 | 人間: 期待する結果を明示したか？ | No | **要対応** | 実装前に期待する結果を言語化する |
| 2 | C1 認識の確認 | AI: 理解を確認してから着手したか？ | No | **要対応** | 着手前に認識合わせを実施する |
| 3 | C2 進捗の共有 | 途中経過が可視化されているか？ | No | **要対応** | 進捗を報告・把握するステップを追加 |
| 4 | C3 不確実性の明示 | 曖昧な部分が隠されていないか？ | Yes（隠されている） | **要対応** | 不確実な部分を明示的に報告する |
| 5 | C4 フィードバック循環 | 検証→修正サイクルが回っているか？ | No | **要対応** | 具体的FBを返し、反映を確認する |
| - | 全原則 | すべて遵守されている | Yes | 通過 | 実行を継続 |

---

## DT-9: AI行動原則チェック表（アウトプット時に適用）

> **AIのアウトプットが原則に適合しているか確認する。**
> 人間がAI出力をレビューする際のチェックリストとして使用。

**ヒットポリシー: C（収集）** — 全ルールを評価

| # | I: 原則 | I: チェック項目 | I: 適合しているか？ | O: 判定 | O: 是正アクション |
|---|--------|---------------|-------------------|---------|-----------------|
| 1 | A1 指示範囲の厳守 | 指示された範囲のみ実装しているか？ | No | **要対応** | スコープ外の実装を除去。提案として分離 |
| 2 | A2 最小構成の選択 | 最もシンプルな実装になっているか？ | No | **要対応** | 過剰な抽象化・共通化を削減 |
| 3 | A3 検証可能な出力 | 検証方法が明示されているか？ | No | **要対応** | 検証コマンド・手順を追加させる |
| 4 | A3 検証可能な出力 | 自信度が明示されているか？ | No | **要対応** | 確実/おそらく/不確実を明示させる |
| 5 | A4 規約の厳守 | CLAUDE.mdの指示に従っているか？ | No | **要対応** | CLAUDE.mdの該当ルールを再適用 |
| 6 | A4 規約の厳守 | Bright Linesに違反していないか？ | Yes（違反） | **即停止** | DT-0（Bright Linesチェック）に戻る |
| - | 全原則 | すべて適合している | Yes | 通過 | アウトプットを受領 |

---

## DT-10: 競合解決表

> **判断が競合するように見える場合に適用。**
> 階層原理により、常に上位レベルの判断が優先される。

**ヒットポリシー: P（優先度）** — 上位レベルの判断が常に優先

| # | I: 競合する状況 | I: 関連レベル | O: 適用される判断基準 | O: 結論 | 優先度 |
|---|---------------|-------------|---------------------|---------|--------|
| 1 | 検証を増やすか減らすか | L2(急がば回れ) vs L3(シンプルさ) | L2が上位 → 検証は挟む | 検証を挟む。ただし各検証はシンプルに | L2優先 |
| 2 | ドキュメントを書くか省略するか | L0(持続可能性) vs L3(シンプルさ) | L0が上位 → 持続可能性で判断 | L0に寄与するなら書く。しないなら省略可 | L0優先 |
| 3 | 損切りを強制するか待つか | L1(心理的安全性) vs L2(急がば回れ) | L1が上位 → 心理的安全性を確保 | 損切りは適用する。ただし「判断であり敗北ではない」と伝える | L1優先 |
| 4 | AI効率化 vs スキル維持 | L0(持続可能性) vs L4(AIファースト) | L0が上位 → 持続可能性を優先 | AIを活用しつつ、月1回は手動実装で能力維持 | L0優先 |

**一般規則:** 上位レベルの判断でNoとなった場合、下位レベルの判断は無条件で「上位制約内での最適化」に切り替わる。

---

## 決定表間の関係図

```
DT-0: Bright Lines事前チェック
  │
  ├── 違反あり → 即座に停止・修正
  │
  └── 通過 ─→ DT-1: L0-L4 階層判断フロー（メインフロー）
                │
                ├── L0評価 ─→ DT-2: L0詳細判断表（G1-G3, R1-R3）
                │     │
                │     └── 通過 → L1へ
                │
                ├── L1評価 ─→ DT-3: L1詳細判断表（P1-P3）
                │     │
                │     └── 通過 → L2へ
                │
                ├── L2評価 ─→ DT-4: L2詳細判断表（H1-H3）
                │     │
                │     └── 通過 → L3へ
                │
                ├── L3評価 ─→ DT-5: L3詳細判断表（S1-S3）
                │     │
                │     └── 通過 → L4へ
                │
                └── L4評価 ─→ DT-6: L4分業判断表（F1-F3）
                      │          └─→ DT-7: プロンプト技法選択表（F4）
                      │
                      └── 実行 ─→ DT-8: 協働原則チェック（C1-C4）
                                    │
                                    └─→ DT-9: AI行動原則チェック（A1-A4）

  ※ 競合発生時 → DT-10: 競合解決表を参照
```

---

## 検証チェックリスト

- [x] L0の入力条件・出力アクションがDMN形式で記述されている
- [x] L1の入力条件・出力アクションがDMN形式で記述されている
- [x] L2の入力条件・出力アクションがDMN形式で記述されている
- [x] L3の入力条件・出力アクションがDMN形式で記述されている
- [x] L4の入力条件・出力アクションがDMN形式で記述されている
- [x] Bright Linesが事前チェック表として独立している
- [x] 各表にヒットポリシーが明示されている
- [x] 各表の入力列(I)と出力列(O)が区別されている
- [x] 決定表間の関係（呼び出し順序）が示されている
- [x] 協働原則(C1-C4)・AI行動原則(A1-A4)のチェック表がある
- [x] 競合解決表に優先度ルールが明記されている

---

## スコープ外の提案（参考情報）

以下はT2のスコープ外だが、今後の検討事項として記録：

1. **定量的閾値の追加**: 現在の入力条件は定性的（Yes/No）だが、将来的に定量指標（複雑度メトリクス、経過時間等）を追加可能
2. **決定表の実行可能化**: Markdown表からXStateやDrools等のルールエンジン形式への変換（フェーズ2以降）
3. **テストケース生成**: 各決定表のルール組み合わせから、フレームワーク適用のテストシナリオを自動生成
