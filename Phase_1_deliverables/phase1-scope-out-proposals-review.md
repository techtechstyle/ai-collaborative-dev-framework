# フェーズ1 スコープ外提案の整理と対応タイミング検討

> **目的**: T2〜T7で蓄積されたスコープ外提案を分類・整理し、対応タイミングを検討するための資料
> **作成日**: 2026-02-10
> **状態**: 検討中（判断はHideさんが実施）

---

## 1. 提案の全体像

フェーズ1（T1〜T7）で蓄積されたスコープ外提案は**計19件**。性質により4グループに分類される。

| グループ | 性質 | 件数 | 概要 |
|---------|------|------|------|
| **A. 品質・整合性の修正** | フェーズ1成果物を「使える状態」にする | 3件 | 記法統一、レンダリング検証 |
| **B. 表現力の強化** | フローの理解しやすさを向上させる | 4件 | スイムレーン、俯瞰図、アノテーション |
| **C. テスト・検証系** | フレームワークの正しさを機械的に確認する | 4件 | テストケース化、依存関係分析 |
| **D. 実行可能化・自動化** | 形式化の最終形態に近づける | 8件 | ルールエンジン化、形式検証、インタラクティブ化 |

---

## 2. グループ別の詳細

### A. 品質・整合性の修正（3件）

> フェーズ1の成果物を後続で参照する際の「前提条件」に該当する作業。

| # | 提案内容 | 出典 | 作業規模 | 依存関係 |
|---|---------|------|---------|---------|
| A1 | T4とT6のMermaid記法の差異統一（開始/終了イベントの記法、style指定の有無、ID命名規則） | セッション引き継ぎ §4 | 小〜中 | なし |
| A2 | Mermaid図のレンダリング検証（プレビューツールでの表示確認） | T4 | 小 | A1の後が効率的 |
| A3 | T4とT6の配色・ノード形状の統一ガイドライン策定 | T6 | 小 | A1と同時実施が効率的 |

**記法差異の具体内容（セッション引き継ぎ §4より）:**

| 要素 | T4の記法 | T6の記法 |
|------|---------|---------|
| 開始イベント | `(["テキスト"])` | `(("テキスト"))` |
| 終了イベント | `(("テキスト"))` | `((("テキスト")))` |
| style指定 | なし | あり（配色ルール適用） |
| ID命名 | ハイフン使用（例: SE_1） | アンダースコア統一（例: LC_SE） |

---

### B. 表現力の強化（4件）

> フレームワークを他者に見せる・チームに展開する段階で価値が出る作業。

| # | 提案内容 | 出典 | 作業規模 | 依存関係 |
|---|---------|------|---------|---------|
| B1 | スイムレーン導入（人間/AI/ツールの3レーン） | T3, T4, T6（3箇所で重複） | 中〜大 | Mermaidの制約あり。bpmn.io等への移行判断が先に必要 |
| B2 | フロー間リンクの統合俯瞰図（全6図を1枚に） | T4 | 中 | A1（記法統一）の後 |
| B3 | タイマーイベント・カウンターの視覚的表現 | T5 | 中 | BPMN描画ツール移行が前提 |
| B4 | 復帰フロー実践例のアノテーション（図上にユースケース付加） | T6 | 小 | なし |

**B1に関する補足**: 3つの異なるタスク（T3, T4, T6）で繰り返し提案されている点は、必要性の高さを示唆している。ただしMermaid flowchartのスイムレーン対応は限定的であるため、描画ツールの選定判断を含む。

---

### C. テスト・検証系（4件）

> フレームワークの正しさ・一貫性を確認するための作業。

| # | 提案内容 | 出典 | 作業規模 | 依存関係 |
|---|---------|------|---------|---------|
| C1 | T7不変条件からのテストケース化（違反ケース＋正常ケースのペア生成） | T7 | 中 | T7完了済み。実運用フィードバック後が効果的 |
| C2 | 復帰フロー実践例のテストケース化（型エラー3往復→B:再分解→CLAUDE.md追記等） | T5 | 小 | C1と同時実施可能 |
| C3 | 決定表（DT-0〜DT-10）からのテストシナリオ自動生成 | T2 | 中 | C1の方法論確立後 |
| C4 | 不変条件間の依存関係分析（INV-RF2→INV-DO1等の関係整理） | T7 | 中 | C1のテスト設計の前提になりうる |

---

### D. 実行可能化・自動化（8件）

> 形式仕様の機械的実行・検証を目指す作業。学習コストが高いものが多い。

| # | 提案内容 | 出典 | 作業規模 | 依存関係 |
|---|---------|------|---------|---------|
| D1 | 決定表のルールエンジン形式への変換（XState/Drools等） | T2 | 大 | TypeScript/Rust学習と連動可能 |
| D2 | 不変条件の形式検証（TLA+/Alloy等） | T7 | 大 | 学習コスト高。C4の後 |
| D3 | 実行時チェックの自動化（CLAUDE.mdに不変条件チェック組み込み） | T7 | 中 | D1またはD2の成果を活用 |
| D4 | インタラクティブ化（Mermaid clickディレクティブで詳細フロー遷移） | T6 | 中 | VitePress移行との同時実施が自然 |
| D5 | メッセージフロー追加（人間⇔AI間のC1-C4通信を表現） | T3 | 中 | B1（スイムレーン）導入後 |
| D6 | エラー境界イベント追加（AI応答不能等の例外パス） | T3 | 中 | BPMN描画ツール移行が前提 |
| D7 | 定量的閾値の追加（複雑度メトリクス、経過時間等をDTに追加） | T2 | 中 | 運用データの蓄積が必要 |
| D8 | 日次/週次共有の別フロー化（RF-T11の後続プロセスを独立フローに） | T5 | 小 | チーム運用開始時に必要 |

---

## 3. 対応タイミングの検討軸

### 検討すべき問い

| # | 問い | 影響するグループ |
|---|------|----------------|
| Q1 | フェーズ2の内容は何か？（フェーズ1成果物をどう使うか） | A, C |
| Q2 | VitePress移行のタイムラインはいつか？ | B, D4 |
| Q3 | Zenn公開やチーム展開の時期は？ | B全般 |
| Q4 | TypeScript/Rust学習プロジェクトとの連動を考えるか？ | D1 |
| Q5 | フレームワークの実運用（自分のプロジェクトへの適用）はいつ始まるか？ | C, D7 |

### タイミングの選択肢

| タイミング | 候補作業 | 判断基準 |
|-----------|---------|---------|
| **フェーズ2の前**（今すぐ） | A1, A2, A3 | フェーズ1成果物の品質を担保してから次に進む |
| **フェーズ2と並行** | B4, C4 | 小規模で独立して実施可能 |
| **他者に見せる前** | B1, B2 | チーム展開やZenn公開の決定後 |
| **実運用で知見が溜まった後** | C1, C2, C3, D7 | YAGNI原則。実際に必要性が判明してから |
| **学習プロジェクトとして** | D1, D2 | TypeScript/Rust等の学習目標と組み合わせ |
| **必要になったら** | B3, D3, D5, D6, D8 | 現時点では優先度が低い |

---

## 4. フレームワーク原則との照合

本検討にあたり、フレームワーク自身の原則に照らして判断すべき点を記載する。

| 原則 | 本検討への適用 |
|------|---------------|
| **S1: YAGNI**（今必要なものだけ） | D群の多くは「将来のため」に該当する可能性あり |
| **L0: 持続可能性**（1年後のチームにプラスか） | A群は成果物の長期的な利用価値に直結する |
| **H3: 準備と振り返りに投資** | A群はフェーズ2の「準備」に相当する |
| **P3: 完璧より改善** | 全提案を一度にやろうとしないこと |
| **L2: 急がば回れ** | A群を飛ばしてフェーズ2に入ると、後で記法変換コストが蓄積する |

---

## 5. 判断メモ欄

> 以下はHideさんが検討結果を記録するためのスペースです。

### 対応する提案

| 提案# | タイミング | メモ |
|-------|-----------|------|
| | | |
| | | |
| | | |

### 対応しない（または保留する）提案

| 提案# | 理由 | メモ |
|-------|------|------|
| | | |
| | | |
| | | |

### 追加で検討が必要な事項

- 
- 
- 

---

## 出典

- `phase1-t2-dmn-decision-tables.md` — スコープ外の提案（3件）
- `phase1-t3-bpmn-elements.md` — スコープ外の提案（3件）
- `phase1-t4-mermaid-flowcharts.md` — スコープ外の提案（3件）
- `phase1-t5-losscutrecovery-bpmn.md` — スコープ外の提案（4件）
- `phase1-t6-losscut-recovery-mermaid.md` — スコープ外の提案（4件）
- `phase1-t7-invariants.md` — スコープ外の提案（4件）
- `session-handoff-summary_4.md` §4 — T4/T6記法差異の記録、§8 — 既出の提案一覧
