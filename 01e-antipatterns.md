## 7. アンチパターン [L1]

### 核心:よくある失敗を避ける

AI協働開発には、従来の開発とは異なる「やってはいけないこと」がある。

### 🚫 Bright Lines:絶対に越えてはいけない一線

通常のアンチパターンは「避けるべきこと」ですが、
**Bright Lines(ブライトライン)** は「絶対に越えてはいけない一線」です。

これらは状況に関係なく、いかなる理由があっても違反してはいけません。

```
┌─────────────────────────────────────────────────────────────────┐
│                    Bright Lines(絶対的禁止)                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  🚫 BL1: 人間の最終判断権を放棄する                             │
│  ──────────────────────────────────                             │
│  「Claudeがそう言ったから」を最終的な判断理由にしない           │
│  判断の責任は常に人間が持つ                                     │
│                                                                 │
│  🚫 BL2: 検証なしで本番環境に適用する                           │
│  ──────────────────────────────────                             │
│  どれだけ自信があっても、本番適用前には必ず検証する             │
│  「Claudeが完璧と言った」は検証の代替にならない                 │
│                                                                 │
│  🚫 BL3: 理解せずにコードを採用する                             │
│  ──────────────────────────────────                             │
│  「動いたからOK」で理解を省略しない                             │
│  説明できないコードは本番に入れない                             │
│                                                                 │
│  🚫 BL4: AIの出力を盲目的に信頼する                             │
│  ──────────────────────────────────                             │
│  Claudeは自信満々に間違える(過剰自信)                         │
│  存在しないAPIを作り出すことがある(幻覚)                      │
│  「AIだから正しい」という前提を持たない                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

#### Bright Lines vs 通常のアンチパターン

| 分類 | 例 | 違反時の対応 |
|------|-----|------------|
| **Bright Lines** | 検証なしで本番適用 | **即座に停止・修正** |
| **Bright Lines** | 理解せずに採用 | **即座に停止・修正** |
| 通常のアンチパターン | 曖昧な指示 | 改善を心がける |
| 通常のアンチパターン | CLAUDE.mdの更新忘れ | 次回から注意 |

> 💡 **Bright Linesは「交渉不可能」**
> 締め切りが迫っていても、上司に急かされても、これらは破ってはいけません。
> 短期的な効率のために長期的な信頼性を犠牲にすることは、
> 持続可能性(L0)に反します。

---

### ❌ アンチパターン1: ドキュメント丸投げ

**問題:**
- 重要な部分が埋もれる
- 精度が下がる(Lost in the Middle)
- 何が優先かわからない

```
❌ Before
「この50ページの要件定義書を読んで全部実装して」

✅ After
「要件定義書の"3.2 認証機能"の部分だけ読んで、
 /modules/auth のログインAPIを実装して」
```

### ❌ アンチパターン2: 巨大ファイル

**問題:**
- 後半で一貫性が崩れる
- 修正箇所の特定が困難
- レビューが難しい

```
❌ Before
「UserService.ts に全機能を実装して」(結果:800行)

✅ After
「以下のファイルに分割して実装して:
 ・UserEntity.ts(50行)
 ・UserRepository.ts(100行)
 ・CreateUserUseCase.ts(80行)
 ・UpdateUserUseCase.ts(80行)」
```

### ❌ アンチパターン3: 曖昧な指示

**問題:**
- 期待と異なる結果になる
- 手戻りが発生する
- Claudeが推測で補完する

```
❌ Before
「いい感じにユーザー管理機能を作って」

✅ After
「ユーザー管理機能を実装して:
 ・CRUD操作(作成・取得・更新・削除)
 ・バリデーション(メール形式、必須項目)
 ・エラーハンドリング(404、400を適切に返す)
 ・テストも作成
 完了後、typecheckとtestを実行して結果を教えて」
```

### ❌ アンチパターン4: 口頭での前提伝達

**問題:**
- Claudeは会話を跨いで記憶しない
- 同じClaudeインスタンスでも長い会話では忘れる
- 暗黙の前提は伝わらない

```
❌ Before
「前に話したあの認証の件、続きをやって」

✅ After
「認証機能の続きを実装します。
 前提:
 ・JWT認証を採用(CLAUDE.md参照)
 ・UserエンティティはUser.tsに実装済み
 今回:ログインAPIを実装してください」
```

### ❌ アンチパターン5: 検証なしの連続実装

**問題:**
- エラーが蓄積する
- 原因特定が困難になる
- 手戻りが大きくなる

```
❌ Before
「認証、ユーザー管理、研修管理を全部一気に作って」

✅ After
「以下の順序で実装して、各ステップで検証してください:

 1. Userエンティティを作成 → typecheck
 2. ログインAPIを実装 → typecheck + test
 3. 認証ミドルウェアを実装 → typecheck + test

 各ステップで検証が通ってから次に進んでください」
```

### ❌ アンチパターン6: Claudeへの過信

**問題:**
- Claudeは間違いも自信満々に言う(過剰自信)
- 存在しないAPIを作り出すことがある(幻覚)
- エッジケースを見落とすことがある(省略)

```
❌ Before
Claude: 「このコードで完璧に動きます」
人間: 「OK、そのままマージしよう」

✅ After
Claude: 「このコードで完璧に動きます」
人間: 「typecheck、lint、testを実行して結果を見せて」
Claude: 「typecheckで2件エラーがありました...」
人間: 「修正して、再度検証して」
```

### アンチパターン早見表

| アンチパターン | ❌ やりがち | ✅ 正しい方法 |
|---------------|-----------|-------------|
| ドキュメント丸投げ | 全ページを一度に渡す | 必要な部分だけ抽出 |
| 巨大ファイル | 1ファイル500行超 | 300行以下に分割 |
| 曖昧な指示 | 「いい感じに」 | 具体的な要件を明示 |
| 口頭の前提 | 「前に話した件」 | CLAUDE.mdに記録/毎回明示 |
| 検証なし連続 | 「全部一気に」 | 1タスクごとに検証 |
| 過信 | 「AIだから正しい」 | 必ず検証する |

---


---

← [役割分担](./01d-roles.md) | [効率と品質](./01f-efficiency.md) →
