# ä»˜éŒ²C: æŒ‡ç¤ºè¨­è¨ˆã‚¬ã‚¤ãƒ‰

> ã“ã®ä»˜éŒ²ã§ã¯ã€Claudeã¸ã®æŒ‡ç¤ºã‚’è¨­è¨ˆã™ã‚‹éš›ã®åŸå‰‡ã¨ã€ãã®æ ¹æ‹ ã‚’è§£èª¬ã—ã¾ã™ã€‚
> ã€Œãªãœãã†ã™ã‚‹ã®ã‹ã€ã‚’ç†è§£ã™ã‚‹ã“ã¨ã§ã€çŠ¶æ³ã«å¿œã˜ãŸåˆ¤æ–­ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
>
> **æ³¨æ„**: ã“ã®ä»˜éŒ²ã¯ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ãƒªãƒ³ã‚°ã®åŸºç¤ã‚’æ‰±ã„ã¾ã™ã€‚
> Part 1-3ã®å®Ÿè·µãŒã§ãã¦ã„ã‚Œã°ã€å¿…è¦ã«å¿œã˜ã¦å‚ç…§ã—ã¦ãã ã•ã„ã€‚
>
> **é‡è¦**: æŒ‡ç¤ºã®åˆ†å‰²åˆ¤æ–­ã¯ [Part 0ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡](./00-philosophy.md#1æ–‡1æ¤œè¨¼åŸå‰‡--ã‚·ãƒ³ãƒ—ãƒ«ã•ã®åˆ¤æ–­åŸºæº–) ãŒåŸºæœ¬ã§ã™ã€‚
> ã“ã®ä»˜éŒ²ã§ã¯ã€ãã®åŸå‰‡ã‚’**æŒ‡ç¤ºè¨­è¨ˆã®è¦³ç‚¹**ã‹ã‚‰è£œå®Œã™ã‚‹æƒ…å ±ã‚’æä¾›ã—ã¾ã™ã€‚

---

## 3è¡Œã§è¨€ã†ã¨

1. **æ§‹é€ ãƒ»æ˜ç¤ºæ€§ãƒ»å…·ä½“æ€§ã®3å±¤ã§æŒ‡ç¤ºã‚’è¨­è¨ˆã™ã‚‹**
2. **æ ¹æ‹ ã®å¼·ã•ã‚’ç†è§£ã—ã¦ã€åŸå‰‡ã‚’é©åˆ‡ã«é©ç”¨ã™ã‚‹**
3. **æŒ‡ç¤ºãŒè¤‡é›‘ã«ãªã£ãŸã‚‰ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡ã«ç«‹ã¡è¿”ã‚‹**

---

## C.1 æŒ‡ç¤ºè¨­è¨ˆã®3å±¤ãƒ¢ãƒ‡ãƒ«

Claudeã¸ã®æŒ‡ç¤ºã¯ã€3ã¤ã®å±¤ã§è¨­è¨ˆã™ã‚‹ã¨æ•´ç†ã—ã‚„ã™ã„ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æŒ‡ç¤ºè¨­è¨ˆã®3å±¤ãƒ¢ãƒ‡ãƒ«                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Layer 1: æ§‹é€ (ã©ã†ä¸¦ã¹ã‚‹ã‹)                                  â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  æƒ…å ±ã®é…ç½®é †åºã€ãƒªã‚¹ãƒˆã®å½¢å¼ã€éšå±¤ã®æ·±ã•                       â”‚
â”‚                                                                 â”‚
â”‚  Layer 2: æ˜ç¤ºæ€§(ä½•ã‚’ä¼ãˆã‚‹ã‹)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  å®Œäº†æ¡ä»¶ã€å‚ç…§æƒ…å ±ã€åˆ¶ç´„ã€æœŸå¾…å‡ºåŠ›                             â”‚
â”‚                                                                 â”‚
â”‚  Layer 3: å…·ä½“æ€§(ã©ã†ä¼ãˆã‚‹ã‹)                                â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                  â”‚
â”‚  æŠ½è±¡èªã®æ’é™¤ã€å‹å®šç¾©ã€ã‚³ãƒ¼ãƒ‰ä¾‹ã€Before/After                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Layer 1: æ§‹é€ (ã©ã†ä¸¦ã¹ã‚‹ã‹)

æƒ…å ±ã®é…ç½®ã«ã‚ˆã£ã¦ã€Claudeã®å‡¦ç†ç²¾åº¦ãŒå¤‰ã‚ã‚‹ã€‚

| åŸå‰‡ | å†…å®¹ | æ ¹æ‹ ãƒ¬ãƒ™ãƒ« |
|------|------|-----------|
| é‡è¦æƒ…å ±ã¯å…ˆé ­ã‹æœ«å°¾ã« | ä¸­é–“éƒ¨åˆ†ã¯è¦‹è½ã¨ã—ã‚„ã™ã„ | â˜…â˜…â˜… ç ”ç©¶ã§å®Ÿè¨¼ |
| éšå±¤ãƒã‚¹ãƒˆã‚ˆã‚Šé †åºãƒªã‚¹ãƒˆ | ãƒã‚¹ãƒˆãŒæ·±ã„ã¨æ¡ä»¶ã®çµ„ã¿åˆã‚ã›ã§æ··ä¹± | â˜…â˜…â˜† çµŒé¨“å‰‡ |
| 1æŒ‡ç¤º1ã‚¿ã‚¹ã‚¯ | è¤‡åˆæŒ‡ç¤ºã§è§£é‡ˆãŒæºã‚Œã‚„ã™ã„ | â˜…â˜…â˜† çµŒé¨“å‰‡ |

#### å®Ÿè·µä¾‹:æƒ…å ±é…ç½®

```
âŒ é‡è¦ãªåˆ¶ç´„ãŒä¸­é–“ã«åŸ‹ã‚‚ã‚Œã‚‹

ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
 CRUDã®åŸºæœ¬æ“ä½œã‚’ä½œæˆã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚‚è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
 ãªãŠã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…ãšbcryptã§ãƒãƒƒã‚·ãƒ¥åŒ–ã—ã¦ãã ã•ã„ã€‚
 ãƒ†ã‚¹ãƒˆã‚‚ä½œæˆã—ã€å®Œäº†ã—ãŸã‚‰typecheckã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ã€

âœ… é‡è¦ãªåˆ¶ç´„ã‚’å…ˆé ­ã«é…ç½®

ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

 ã€å¿…é ˆåˆ¶ç´„ã€‘
 ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯å¿…ãšbcryptã§ãƒãƒƒã‚·ãƒ¥åŒ–

 ã€å®Ÿè£…å†…å®¹ã€‘
 1. CRUDã®åŸºæœ¬æ“ä½œ
 2. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
 3. ãƒ†ã‚¹ãƒˆ

 ã€å®Œäº†æ¡ä»¶ã€‘
 typecheckã‚’å®Ÿè¡Œã—ã¦çµæœã‚’å ±å‘Šã€
```

#### å®Ÿè·µä¾‹:ãƒªã‚¹ãƒˆæ§‹é€ 

```
âŒ ãƒã‚¹ãƒˆãŒæ·±ã„

ã€Œèªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„:
 - ãƒ­ã‚°ã‚¤ãƒ³
   - ãƒ¡ãƒ¼ãƒ«èªè¨¼
     - OTPé€ä¿¡
       - æœ‰åŠ¹æœŸé™ã¯5åˆ†
     - OTPæ¤œè¨¼
   - ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³
     - Google
     - GitHubã€

âœ… ãƒ•ãƒ©ãƒƒãƒˆãªé †åºãƒªã‚¹ãƒˆ

ã€Œèªè¨¼æ©Ÿèƒ½ã‚’ä»¥ä¸‹ã®é †åºã§å®Ÿè£…ã—ã¦ãã ã•ã„:

 1. ãƒ¡ãƒ¼ãƒ«ãƒ­ã‚°ã‚¤ãƒ³(OTPæ–¹å¼ã€æœ‰åŠ¹æœŸé™5åˆ†)
 2. Googleã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³
 3. GitHubã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒ­ã‚°ã‚¤ãƒ³

 å„ã‚¹ãƒ†ãƒƒãƒ—ã§å®Œäº†å¾Œã€typecheckã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚ã€
```

### Layer 2: æ˜ç¤ºæ€§(ä½•ã‚’ä¼ãˆã‚‹ã‹)

æ›–æ˜§ã•ã‚’æ’é™¤ã—ã€å¿…è¦ãªæƒ…å ±ã‚’æ˜ç¤ºçš„ã«ä¼ãˆã‚‹ã€‚

| åŸå‰‡ | å†…å®¹ | æ ¹æ‹ ãƒ¬ãƒ™ãƒ« |
|------|------|-----------|
| å®Œäº†æ¡ä»¶ã‚’æ˜è¨˜ | æ›–æ˜§ã ã¨éå‰°/éå°‘ãªå‡ºåŠ›ã«ãªã‚‹ | â˜…â˜…â˜… è«–ç†çš„ã«æ˜ç¢º |
| å‚ç…§æƒ…å ±ã‚’æŒ‡å®š | é–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ˜ç¤ºã—ãªã„ã¨å‚ç…§ã•ã‚Œãªã„ | â˜…â˜…â˜… ä»•æ§˜ä¸Šæ˜ç¢º |
| åˆ¶ç´„ã®å„ªå…ˆé †ä½ | ç«¶åˆæ™‚ã®åˆ¤æ–­åŸºæº–ãŒãªã„ã¨æºã‚Œã‚‹ | â˜…â˜…â˜† çµŒé¨“å‰‡ |
| æœŸå¾…å‡ºåŠ›å½¢å¼ | å½¢å¼ãŒæ›–æ˜§ã ã¨æ¯å›ç•°ãªã‚‹å½¢å¼ã«ãªã‚‹ | â˜…â˜…â˜† çµŒé¨“å‰‡ |

#### å®Ÿè·µä¾‹:å®Œäº†æ¡ä»¶

```
âŒ å®Œäº†æ¡ä»¶ãŒæ›–æ˜§

ã€Œãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€

âœ… å®Œäº†æ¡ä»¶ã‚’æ˜è¨˜

ã€Œãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

 ã€å®Œäº†æ¡ä»¶ã€‘
 ãƒ»POST /api/auth/login ãŒå‹•ä½œã™ã‚‹
 ãƒ»ä¸æ­£ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§401ãŒè¿”ã‚‹
 ãƒ»typecheck, lint, testãŒã™ã¹ã¦é€šéã€
```

#### å®Ÿè·µä¾‹:åˆ¶ç´„ã®å„ªå…ˆé †ä½

```
âŒ å„ªå…ˆé †ä½ãŒä¸æ˜

ã€Œã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’ç¢ºä¿ã—ã¤ã¤ã€ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚‚æœ€é©åŒ–ã—ã¦ãã ã•ã„ã€

âœ… å„ªå…ˆé †ä½ã‚’æ˜ç¤º

ã€Œä»¥ä¸‹ã®å„ªå…ˆé †ä½ã§å®Ÿè£…ã—ã¦ãã ã•ã„:

 æœ€å„ªå…ˆ: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£(SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–å¿…é ˆ)
 æ¬¡ç‚¹: å¯èª­æ€§(ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰)
 å¯èƒ½ãªã‚‰: ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–

 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒç«¶åˆã™ã‚‹å ´åˆã€
 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å„ªå…ˆã—ã¦ãã ã•ã„ã€‚ã€
```

### Layer 3: å…·ä½“æ€§(ã©ã†ä¼ãˆã‚‹ã‹)

æŠ½è±¡çš„ãªè¡¨ç¾ã‚’é¿ã‘ã€å…·ä½“çš„ã«ä¼ãˆã‚‹ã€‚

| åŸå‰‡ | å†…å®¹ | æ ¹æ‹ ãƒ¬ãƒ™ãƒ« |
|------|------|-----------|
| æŠ½è±¡èªã‚’é¿ã‘ã‚‹ | ã€Œé©åˆ‡ã«ã€ã€Œã„ã„æ„Ÿã˜ã«ã€ã¯è§£é‡ˆãŒæºã‚Œã‚‹ | â˜…â˜…â˜… è«–ç†çš„ã«æ˜ç¢º |
| å‹å®šç¾©ã§æ„å›³ã‚’ç¤ºã™ | è‡ªç„¶è¨€èªã‚ˆã‚Šå‹ãŒæ›–æ˜§ã•ã‚’æ’é™¤ | â˜…â˜…â˜… ä»•æ§˜ä¸Šæ˜ç¢º |
| å…·ä½“ä¾‹ã‚’æ·»ãˆã‚‹ | ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ãŒå¼·ã„ãŸã‚åŠ¹æœçš„ | â˜…â˜…â˜† çµŒé¨“å‰‡ |
| å¦å®šã‚ˆã‚Šè‚¯å®š | ã€Œã€œã—ãªã„ã€ã‚ˆã‚Šã€Œã€œã™ã‚‹ã€ãŒæ˜ç¢º | â˜…â˜†â˜† å‚¾å‘ |

#### å®Ÿè·µä¾‹:æŠ½è±¡èªã®æ’é™¤

```
âŒ æŠ½è±¡çš„

ã€Œé©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€

âœ… å…·ä½“çš„

ã€Œä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„:

 ãƒ»ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚¨ãƒ©ãƒ¼ â†’ 400 Bad Request + ã‚¨ãƒ©ãƒ¼è©³ç´°
 ãƒ»èªè¨¼ã‚¨ãƒ©ãƒ¼ â†’ 401 Unauthorized
 ãƒ»æ¨©é™ã‚¨ãƒ©ãƒ¼ â†’ 403 Forbidden
 ãƒ»å­˜åœ¨ã—ãªã„ãƒªã‚½ãƒ¼ã‚¹ â†’ 404 Not Found
 ãƒ»ã‚µãƒ¼ãƒãƒ¼ã‚¨ãƒ©ãƒ¼ â†’ 500 Internal Server Error + ãƒ­ã‚°å‡ºåŠ›ã€
```

#### å®Ÿè·µä¾‹:å‹å®šç¾©ã§æ„å›³ã‚’ç¤ºã™

```
âŒ è‡ªç„¶è¨€èªã®ã¿

ã€Œãƒ­ã‚°ã‚¤ãƒ³APIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
 ãƒ¡ãƒ¼ãƒ«ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å—ã‘å–ã£ã¦ã€
 æˆåŠŸã—ãŸã‚‰ãƒˆãƒ¼ã‚¯ãƒ³ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¿”ã—ã¦ãã ã•ã„ã€‚ã€

âœ… å‹å®šç¾©ã‚’æ·»ãˆã‚‹

ã€Œãƒ­ã‚°ã‚¤ãƒ³APIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

 ã€å‹å®šç¾©ã€‘
 // ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
 type LoginRequest = {
   email: string
   password: string
 }

 // ãƒ¬ã‚¹ãƒãƒ³ã‚¹
 type LoginResponse = {
   accessToken: string
   user: {
     id: UserId
     email: string
     name: string
     role: 'admin' | 'user'
   }
 }

 // ã‚¨ãƒ©ãƒ¼
 type LoginError =
   | { type: 'InvalidCredentials' }
   | { type: 'AccountLocked'; unlocksAt: Date }

 ã“ã®å‹å®šç¾©ã«å¾“ã£ã¦å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚ã€
```

---

## C.2 Claudeæœ€é©åŒ–ã®è¦³ç‚¹

ä»¥ä¸‹ã®åŸå‰‡ã¯ã€æ ¹æ‹ ã®å¼·ã•ã«ã‚ˆã£ã¦3æ®µéšã«åˆ†é¡ã—ã¦ã„ã¾ã™ã€‚
é©ç”¨æ™‚ã¯ã€æ ¹æ‹ ãƒ¬ãƒ™ãƒ«ã‚’æ„è­˜ã—ã¦åˆ¤æ–­ã—ã¦ãã ã•ã„ã€‚

### æ ¹æ‹ ãƒ¬ãƒ™ãƒ«ã®å®šç¾©

| ãƒ¬ãƒ™ãƒ« | æ„å‘³ | é©ç”¨ã®è€ƒãˆæ–¹ |
|--------|------|-------------|
| â˜…â˜…â˜… | ç ”ç©¶ãƒ»ä»•æ§˜ã§å®Ÿè¨¼æ¸ˆã¿ | å¸¸ã«é©ç”¨ã™ã¹ã |
| â˜…â˜…â˜† | çµŒé¨“å‰‡ã¨ã—ã¦æœ‰åŠ¹ | åŸºæœ¬çš„ã«é©ç”¨ã€ä¾‹å¤–ã‚ã‚Š |
| â˜…â˜†â˜† | å‚¾å‘ã¨ã—ã¦è¦³å¯Ÿã•ã‚Œã‚‹ | çŠ¶æ³ã«å¿œã˜ã¦åˆ¤æ–­ |

### â˜…â˜…â˜… ç ”ç©¶ãƒ»ä»•æ§˜ã«åŸºã¥ãåŸå‰‡

ã“ã‚Œã‚‰ã¯å¸¸ã«æ„è­˜ã™ã¹ãåŸå‰‡ã§ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡1: é‡è¦æƒ…å ±ã¯å…ˆé ­ã‹æœ«å°¾ã«é…ç½®                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ ¹æ‹ : Lost in the Middleå•é¡Œ                                   â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
â”‚  LLMã¯é•·ã„ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã®ä¸­é–“éƒ¨åˆ†ã‚’è¦‹è½ã¨ã—ã‚„ã™ã„ã€‚              â”‚
â”‚  ç ”ç©¶ã«ã‚ˆã‚Šå®Ÿè¨¼ã•ã‚Œã¦ã„ã‚‹ã€‚                                     â”‚
â”‚                                                                 â”‚
â”‚  å‚è€ƒ: Liu et al. (2023)                                        â”‚
â”‚       "Lost in the Middle: How Language Models Use Long Contexts"â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»å¿…é ˆåˆ¶ç´„ã¯æŒ‡ç¤ºã®æœ€åˆã«                                       â”‚
â”‚  ãƒ»æ¤œè¨¼æŒ‡ç¤ºã¯æœ€å¾Œã«                                             â”‚
â”‚  ãƒ»è£œè¶³æƒ…å ±ã¯ä¸­é–“ã§ã‚‚å¯                                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡2: ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã¯å¿…è¦ååˆ†ã«                                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ ¹æ‹ : ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã®åˆ¶é™ã¨ç²¾åº¦ã®ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€            â”‚
â”‚  ãƒ»æƒ…å ±ãŒå¤šã™ãã‚‹ã¨é‡è¦éƒ¨åˆ†ãŒåŸ‹ã‚‚ã‚Œã‚‹                           â”‚
â”‚  ãƒ»æƒ…å ±ãŒå°‘ãªã™ãã‚‹ã¨å¿…è¦ãªæ–‡è„ˆãŒãªã„                           â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»ä½œæ¥­å¯¾è±¡ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ˜ç¤ºçš„ã«æŒ‡å®š                             â”‚
â”‚  ãƒ»ã€Œãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå…¨ä½“ã‚’èª­ã‚“ã§ã€ã¯é¿ã‘ã‚‹                         â”‚
â”‚  ãƒ»CLAUDE.mdã¯å¸¸ã«è»½é‡ã«ä¿ã¤(3,000æ–‡å­—ä»¥ä¸‹)                   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡3: å‹ãƒ»æ§‹é€ ã§æ„å›³ã‚’ä¼ãˆã‚‹                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  æ ¹æ‹ : è‡ªç„¶è¨€èªã‚ˆã‚Šå‹å®šç¾©ãŒæ›–æ˜§ã•ã‚’æ’é™¤                         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                          â”‚
â”‚  ãƒ»ã€Œæ–‡å­—åˆ—ã€ã‚ˆã‚Šã€Œtype Email = string & {...}ã€ãŒæ˜ç¢º          â”‚
â”‚  ãƒ»å‹ã¯ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã§æ¤œè¨¼å¯èƒ½                                     â”‚
â”‚  ãƒ»Claudeã®å‡ºåŠ›ã‚‚å‹ã§æ¤œè¨¼ã§ãã‚‹                                 â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»æ–°ã—ã„APIã¯å‹å®šç¾©ã‚’å…ˆã«ç¤ºã™                                  â”‚
â”‚  ãƒ»Branded Typeã€Resultå‹ã€Discriminated Unionã‚’æ´»ç”¨            â”‚
â”‚  ãƒ»zodã‚¹ã‚­ãƒ¼ãƒã§å‹ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’çµ±ä¸€                        â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### â˜…â˜…â˜† çµŒé¨“å‰‡ã¨ã—ã¦æœ‰åŠ¹ãªåŸå‰‡

åŸºæœ¬çš„ã«æœ‰åŠ¹ã§ã™ãŒã€çŠ¶æ³ã«ã‚ˆã£ã¦ä¾‹å¤–ãŒã‚ã‚Šã¾ã™ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  è£œè¶³: 1æŒ‡ç¤º1ã‚¿ã‚¹ã‚¯(ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡ã®æŒ‡ç¤ºè¨­è¨ˆã¸ã®é©ç”¨)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡ã®ã€Œ1æ–‡ã€ã‚’æŒ‡ç¤ºè¨­è¨ˆã«é©ç”¨ã—ãŸã‚‚ã®              â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  ã€Œ1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‹?ã€ã‚’æº€ãŸã™æŒ‡ç¤ºã¯ã€è‡ªç„¶ã¨1æŒ‡ç¤º1ã‚¿ã‚¹ã‚¯ã«ãªã‚‹â”‚
â”‚                                                                 â”‚
â”‚  å‚¾å‘: è¤‡åˆæŒ‡ç¤ºã§ã¯è§£é‡ˆãŒæºã‚Œã‚„ã™ã„                             â”‚
â”‚  ãƒ»ã€ŒAã¨Bã‚’ã‚„ã£ã¦ã€ã§å„ªå…ˆé †ä½ãŒä¸æ˜ç¢º                           â”‚
â”‚  ãƒ»ã€ŒAã‚’ã‚„ã£ã¦ã€ã‚‚ã—Cãªã‚‰Bã‚‚ã€ã§æ¡ä»¶ã®è§£é‡ˆãŒæºã‚Œã‚‹              â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»è¤‡åˆæŒ‡ç¤º(ã€ŒAã¨Bã‚’ã‚„ã£ã¦ã€)ã‚’é¿ã‘ã‚‹                         â”‚
â”‚  ãƒ»æ¡ä»¶åˆ†å²(ã€Œã‚‚ã—Cãªã‚‰Bã‚‚ã€)ã‚’é¿ã‘ã‚‹                         â”‚
â”‚  ãƒ»åˆ¤æ–­ã¯ Part 0ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡ ã‚’å‚ç…§                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡5: å®Œäº†æ¡ä»¶ã®æ˜ç¤º                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å‚¾å‘: æ›–æ˜§ã ã¨éå‰°/éå°‘ãªå‡ºåŠ›ã«ãªã‚‹                            â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                             â”‚
â”‚  ãƒ»ã€Œå®Ÿè£…ã—ã¦ã€ã ã‘ã ã¨ã©ã“ã¾ã§ã‚„ã‚‹ã‹ä¸æ˜                       â”‚
â”‚  ãƒ»ãƒ†ã‚¹ãƒˆã‚’å«ã‚€ã®ã‹ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯å¿…è¦ã‹                       â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»ã€Œã€œã—ãŸã‚‰å®Œäº†ã€ã‚’æ˜è¨˜                                       â”‚
â”‚  ãƒ»æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰ã‚’å«ã‚ã‚‹                                         â”‚
â”‚  ãƒ»æˆæœç‰©ã‚’åˆ—æŒ™                                                 â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡6: å…·ä½“ä¾‹ã‚’æ·»ãˆã‚‹                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å‚¾å‘: ãƒ‘ã‚¿ãƒ¼ãƒ³èªè­˜ãŒå¼·ã„ãŸã‚å…·ä½“ä¾‹ãŒåŠ¹æœçš„                     â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                    â”‚
â”‚  ãƒ»æŠ½è±¡çš„ãªèª¬æ˜ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰ä¾‹ãŒä¼ã‚ã‚Šã‚„ã™ã„                     â”‚
â”‚  ãƒ»Before/Afterã®å¯¾æ¯”ãŒç‰¹ã«æœ‰åŠ¹                                 â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ«ãƒ¼ãƒ«ã«ã¯å…·ä½“ä¾‹ã‚’æ·»ãˆã‚‹                         â”‚
â”‚  ãƒ»ã€Œã€‡ã€‡ã®ã‚ˆã†ã«ã€ã¨æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã‚’å‚ç…§ã•ã›ã‚‹                     â”‚
â”‚  ãƒ»ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã‚‚Before/Afterã§ç¤ºã™                           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### â˜…â˜†â˜† å‚¾å‘ã¨ã—ã¦è¦³å¯Ÿã•ã‚Œã‚‹åŸå‰‡

åŠ¹æœãŒã‚ã‚‹å ´åˆã‚‚ã‚ã‚Šã¾ã™ãŒã€ç¢ºå®Ÿã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡7: å¦å®šã‚ˆã‚Šè‚¯å®š                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å‚¾å‘: ã€Œã€œã—ãªã„ã€ã‚ˆã‚Šã€Œã€œã™ã‚‹ã€ã®æ–¹ãŒæ˜ç¢ºãªã“ã¨ãŒå¤šã„         â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€              â”‚
â”‚  ãƒ»ã€Œenumã‚’ä½¿ã‚ãªã„ã€â†’ ä½•ã‚’ä½¿ã†ã‹ä¸æ˜                           â”‚
â”‚  ãƒ»ã€ŒUnionå‹ã‚’ä½¿ã†ã€â†’ æ˜ç¢º                                      â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»DOã‚’å…ˆã«æ›¸ãã€DON'Tã¯è£œè¶³ã¨ã—ã¦                              â”‚
â”‚  ãƒ»ç¦æ­¢äº‹é …ã«ã¯ä»£æ›¿æ‰‹æ®µã‚‚ä½µè¨˜                                   â”‚
â”‚                                                                 â”‚
â”‚  æ³¨æ„:                                                          â”‚
â”‚  ãƒ»ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ä¸Šã®ç¦æ­¢(SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ç­‰)ã¯æ˜ç¤ºçš„ã«ç¦æ­¢  â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡8: å½¹å‰²ã®æ˜ç¤º                                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å‚¾å‘: å‡ºåŠ›ã®ãƒˆãƒ¼ãƒ³ã‚„è©³ç´°åº¦ãŒå®‰å®šã™ã‚‹ã“ã¨ãŒã‚ã‚‹                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                  â”‚
â”‚  ãƒ»ã€Œã‚·ãƒ‹ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ã€                       â”‚
â”‚  ãƒ»ã€Œåˆå¿ƒè€…ã«æ•™ãˆã‚‹ã‚ˆã†ã«èª¬æ˜ã—ã¦ã€                             â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»æœŸå¾…ã™ã‚‹è©³ç´°åº¦ã«åˆã‚ã›ã¦å½¹å‰²ã‚’è¨­å®š                           â”‚
â”‚  ãƒ»ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼æ™‚ã¯è¦³ç‚¹ã‚’æ˜ç¤º                                   â”‚
â”‚                                                                 â”‚
â”‚  æ³¨æ„:                                                          â”‚
â”‚  ãƒ»åŠ¹æœãŒå®‰å®šã—ãªã„å ´åˆã‚‚ã‚ã‚‹                                   â”‚
â”‚  ãƒ»å…·ä½“çš„ãªæŒ‡ç¤ºã®æ–¹ãŒç¢ºå®Ÿ                                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  åŸå‰‡9: æ€è€ƒãƒ—ãƒ­ã‚»ã‚¹ã®è¦æ±‚                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  å‚¾å‘: è¤‡é›‘ãªåˆ¤æ–­ã§ç²¾åº¦ãŒä¸ŠãŒã‚‹ã“ã¨ãŒã‚ã‚‹                       â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                        â”‚
â”‚  ãƒ»ã€Œã¾ãšé¸æŠè‚¢ã‚’åˆ—æŒ™ã—ã€æ¬¡ã«æ¯”è¼ƒã—ã€æœ€å¾Œã«æ¨å¥¨ã‚’è¿°ã¹ã¦ã€       â”‚
â”‚  ãƒ»æ®µéšçš„ã«è€ƒãˆã•ã›ã‚‹                                           â”‚
â”‚                                                                 â”‚
â”‚  å®Ÿè·µ:                                                          â”‚
â”‚  ãƒ»è¨­è¨ˆåˆ¤æ–­ã‚’æ±‚ã‚ã‚‹æ™‚ã«æœ‰åŠ¹                                     â”‚
â”‚  ãƒ»ã‚³ãƒ¼ãƒãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰ã§ã®æ´»ç”¨                                     â”‚
â”‚                                                                 â”‚
â”‚  æ³¨æ„:                                                          â”‚
â”‚  ãƒ»å˜ç´”ãªã‚¿ã‚¹ã‚¯ã§ã¯å†—é•·ã«ãªã‚‹                                   â”‚
â”‚  ãƒ»å®Ÿè£…ã‚¿ã‚¹ã‚¯ã«ã¯é€šå¸¸ä¸è¦                                       â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## C.3 æŒ‡ç¤ºã®è¤‡é›‘ã•ã¸ã®å¯¾å‡¦

### ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡ã®é©ç”¨

æŒ‡ç¤ºãŒè¤‡é›‘ã«æ„Ÿã˜ãŸã‚‰ã€**Part 0ã®ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡**ã«ç«‹ã¡è¿”ã‚‹ã€‚

> **åˆ¤æ–­åŸºæº–**:
> - 1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‹?
> - æ¤œè¨¼1å›ã§å®Œäº†ç¢ºèªã§ãã‚‹ã‹?
>
> â†’ ä¸¡æ–¹ Yes ãªã‚‰å®Ÿè¡Œã€ã©ã¡ã‚‰ã‹ No ãªã‚‰åˆ†è§£
>
> è©³ç´°ã¯ [Part 0: ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡](./00-philosophy.md#1æ–‡1æ¤œè¨¼åŸå‰‡--ã‚·ãƒ³ãƒ—ãƒ«ã•ã®åˆ¤æ–­åŸºæº–) ã‚’å‚ç…§ã€‚

### è¤‡é›‘ã•ã®ã‚·ã‚°ãƒŠãƒ«(å‚è€ƒ)

æŒ‡ç¤ºã‚’æ›¸ã„ã¦ã¿ã¦ä»¥ä¸‹ã®çŠ¶æ…‹ã«ãªã£ãŸã‚‰ã€ã€Œ1æ–‡1æ¤œè¨¼ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ãŒé«˜ã„ã€‚

| ã‚·ã‚°ãƒŠãƒ« | ã€Œ1æ–‡1æ¤œè¨¼ã€ã¨ã®é–¢ä¿‚ |
|---------|---------------------|
| ç®‡æ¡æ›¸ãã®é …ç›®ãŒå¤šã„ | â†’ ã€Œ1æ–‡ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ |
| ãƒã‚¹ãƒˆãŒæ·±ã„ | â†’ ã€Œ1æ–‡ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ |
| æŒ‡ç¤ºãŒé•·ã„ | â†’ ã€Œ1æ–‡ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ |
| ã€Œandã€ã€Œifã€ãŒè¤‡æ•° | â†’ ã€Œ1æ–‡ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ |
| å®Œäº†æ¡ä»¶ãŒè¤‡æ•° | â†’ ã€Œ1æ¤œè¨¼ã€ã‚’æº€ãŸã—ã¦ã„ãªã„å¯èƒ½æ€§ |

> ğŸ’¡ ã“ã‚Œã‚‰ã¯**ã‚·ã‚°ãƒŠãƒ«**ã§ã‚ã‚Šã€åˆ¤æ–­åŸºæº–ã§ã¯ãªã„ã€‚
> åˆ¤æ–­ã¯å¸¸ã«ã€Œ1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‹?ã€ã€Œæ¤œè¨¼1å›ã§ç¢ºèªã§ãã‚‹ã‹?ã€ã§è¡Œã†ã€‚

### åˆ†å‰²ã®å®Ÿè·µä¾‹

```
âŒ åˆ†å‰²å‰(è¤‡é›‘)

ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
 CRUDã®å…¨æ“ä½œã‚’ä½œæˆã—ã€ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è¿½åŠ ã—ã€
 æ¨©é™ãƒã‚§ãƒƒã‚¯ã‚‚å…¥ã‚Œã¦ãã ã•ã„ã€‚
 ç®¡ç†è€…ã®ã¿å‰Šé™¤å¯èƒ½ã§ã€ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è‡ªåˆ†ã®æƒ…å ±ã®ã¿ç·¨é›†å¯èƒ½ã§ã™ã€‚
 ãƒ†ã‚¹ãƒˆã‚‚ä½œæˆã—ã€typecheckã¨lintã¨testã‚’é€šã—ã¦ãã ã•ã„ã€‚ã€

âœ… åˆ†å‰²å¾Œ(ã‚·ãƒ³ãƒ—ãƒ«)

ã€ã‚¿ã‚¹ã‚¯1ã€‘
ã€ŒUserã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚
 å ´æ‰€: src/modules/user/domain/entities/User.ts
 å®Œäº†æ¡ä»¶: typecheckãŒé€šã‚‹ã€

ã€ã‚¿ã‚¹ã‚¯2ã€‘
ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆAPIã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚
 POST /api/users
 å®Œäº†æ¡ä»¶: typecheck + lintãŒé€šã‚‹ã€

ã€ã‚¿ã‚¹ã‚¯3ã€‘
ã€Œæ¨©é™ãƒã‚§ãƒƒã‚¯ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚
 ãƒ«ãƒ¼ãƒ«: å‰Šé™¤ã¯ç®¡ç†è€…ã®ã¿ã€ç·¨é›†ã¯æœ¬äººã¾ãŸã¯ç®¡ç†è€…
 å®Œäº†æ¡ä»¶: typecheck + lint + testãŒé€šã‚‹ã€

(ä»¥ä¸‹ã€ã‚¿ã‚¹ã‚¯ã”ã¨ã«åˆ†å‰²)
```

---

## C.4 æŒ‡ç¤ºãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆé›†

### åŸºæœ¬ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
ã€Œã€ã‚¿ã‚¹ã‚¯ã€‘
 (ä½•ã‚’ã™ã‚‹ã‹1æ–‡ã§)

 ã€å ´æ‰€ã€‘
 (ãƒ•ã‚¡ã‚¤ãƒ«ãƒ‘ã‚¹)

 ã€è¦ä»¶ã€‘
 1. (è¦ä»¶1)
 2. (è¦ä»¶2)
 3. (è¦ä»¶3)

 ã€åˆ¶ç´„ã€‘
 ãƒ»(å¿…é ˆåˆ¶ç´„)

 ã€å®Œäº†æ¡ä»¶ã€‘
 (æ¤œè¨¼ã‚³ãƒãƒ³ãƒ‰)ã‚’å®Ÿè¡Œã—ã¦çµæœã‚’å ±å‘Šã€
```

### å‹å®šç¾©ä»˜ããƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
ã€Œã€ã‚¿ã‚¹ã‚¯ã€‘
 (APIå)ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

 ã€å‹å®šç¾©ã€‘
 ```typescript
 type Request = { ... }
 type Response = { ... }
 type Error = { ... }
 ```

 ã€ãƒ«ãƒ¼ãƒ«ã€‘
 ãƒ»anyã¯ä½¿ç”¨ç¦æ­¢
 ãƒ»ã‚¨ãƒ©ãƒ¼ã¯Resultå‹ã§è¿”ã™

 ã€å®Œäº†æ¡ä»¶ã€‘
 typecheck + lintãŒé€šã‚‹ã€
```

### ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¾é ¼ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
ã€Œä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

 ã€è¦³ç‚¹ã€‘
 1. (ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹1)
 2. (ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹2)
 3. (ãƒ¬ãƒ“ãƒ¥ãƒ¼è¦³ç‚¹3)

 ã€å‡ºåŠ›å½¢å¼ã€‘
 ãƒ»å•é¡Œç‚¹: å•é¡Œã®å†…å®¹ã¨å½±éŸ¿
 ãƒ»æ¨å¥¨: å…·ä½“çš„ãªä¿®æ­£æ¡ˆ
 ãƒ»å„ªå…ˆåº¦: é«˜/ä¸­/ä½

 åˆ¤æ–­ã¯ç§ãŒè¡Œã„ã¾ã™ã€‚é¸æŠè‚¢ã‚’æç¤ºã—ã¦ãã ã•ã„ã€‚ã€
```

### å£æ‰“ã¡(ã‚³ãƒ¼ãƒãƒ³ã‚°ãƒ¢ãƒ¼ãƒ‰)ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ

```markdown
ã€Œ(ãƒˆãƒ”ãƒƒã‚¯)ã«ã¤ã„ã¦å£æ‰“ã¡ã•ã›ã¦ãã ã•ã„ã€‚

 ã€ç¾çŠ¶ã®è€ƒãˆã€‘
 ãƒ»(è€ƒãˆ1)
 ãƒ»(è€ƒãˆ2)

 ã€è¿·ã£ã¦ã„ã‚‹ç‚¹ã€‘
 ãƒ»(è¿·ã„1)
 ãƒ»(è¿·ã„2)

 ã€ãŠé¡˜ã„ã€‘
 ãƒ»ç§ã®è€ƒãˆã‚’æ•´ç†ã™ã‚‹è³ªå•ã‚’ã—ã¦ãã ã•ã„
 ãƒ»é¸æŠè‚¢ã¨ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã‚’æç¤ºã—ã¦ãã ã•ã„
 ãƒ»åˆ¤æ–­ã¯ç§ãŒè¡Œã„ã¾ã™ã€
```

---

## C.5 ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

æŒ‡ç¤ºã‚’å‡ºã™å‰ã«ç¢ºèªã™ã‚‹ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆã€‚

### æ§‹é€ (Layer 1)

- [ ] é‡è¦ãªåˆ¶ç´„ã¯å…ˆé ­ã«é…ç½®ã—ãŸã‹
- [ ] æ¤œè¨¼æŒ‡ç¤ºã¯æœ€å¾Œã«é…ç½®ã—ãŸã‹
- [ ] ãƒã‚¹ãƒˆã¯æµ…ã„ã‹(2æ®µä»¥å†…æ¨å¥¨)
- [ ] 1æŒ‡ç¤º1ã‚¿ã‚¹ã‚¯ã«ãªã£ã¦ã„ã‚‹ã‹

### æ˜ç¤ºæ€§(Layer 2)

- [ ] å®Œäº†æ¡ä»¶ã‚’æ˜è¨˜ã—ãŸã‹
- [ ] å‚ç…§ã™ã¹ããƒ•ã‚¡ã‚¤ãƒ«ã‚’æŒ‡å®šã—ãŸã‹
- [ ] åˆ¶ç´„ã®å„ªå…ˆé †ä½ã¯æ˜ç¢ºã‹
- [ ] æœŸå¾…ã™ã‚‹å‡ºåŠ›å½¢å¼ã‚’ç¤ºã—ãŸã‹

### å…·ä½“æ€§(Layer 3)

- [ ] ã€Œé©åˆ‡ã«ã€ã€Œã„ã„æ„Ÿã˜ã«ã€ã‚’ä½¿ã£ã¦ã„ãªã„ã‹
- [ ] å‹å®šç¾©ã‚„ã‚³ãƒ¼ãƒ‰ä¾‹ã‚’æ·»ãˆãŸã‹
- [ ] ç¦æ­¢äº‹é …ã«ã¯ä»£æ›¿æ‰‹æ®µã‚‚æ›¸ã„ãŸã‹

### ã€Œ1æ–‡1æ¤œè¨¼ã€ç¢ºèª

- [ ] **1æ–‡ã§èª¬æ˜ã§ãã‚‹ã‹?**(æ›–æ˜§ã•ãŒãªã„ã€ã€Œã€œã—ã¦ã€œã—ã¦ã€ãŒãªã„)
- [ ] **æ¤œè¨¼1å›ã§å®Œäº†ç¢ºèªã§ãã‚‹ã‹?**(typecheck/lint/test ã®1ã¤ã§ç¢ºèª)
- [ ] ä¸¡æ–¹ Yes ã§ãªã‘ã‚Œã°åˆ†è§£ã‚’æ¤œè¨

> â†’ è©³ç´°ã¯ [Part 0ã€Œ1æ–‡1æ¤œè¨¼ã€åŸå‰‡](./00-philosophy.md#1æ–‡1æ¤œè¨¼åŸå‰‡--ã‚·ãƒ³ãƒ—ãƒ«ã•ã®åˆ¤æ–­åŸºæº–)

---

## å‚è€ƒæ–‡çŒ®

- Liu et al. (2023) "Lost in the Middle: How Language Models Use Long Contexts"
  https://arxiv.org/abs/2307.03172

---

å‰ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ: [ä»˜éŒ²B: ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°](./appendix-b-troubleshooting.md)
